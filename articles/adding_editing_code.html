<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Changing generated code • ckbplotr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Changing generated code">
<meta property="og:description" content="ckbplotr">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ckbplotr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ckbplotr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/plot_like_ckb.html">Make any ggplot like a CKB plot</a>
    </li>
    <li>
      <a href="../articles/make_forest_plot.html">More with forest plots</a>
    </li>
    <li>
      <a href="../articles/make_shape_plot.html">More with shape plots</a>
    </li>
    <li>
      <a href="../articles/adding_editing_code.html">Changing generated code</a>
    </li>
    <li>
      <a href="../articles/special_characters_formatting.html">Using special characters and formatting</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/index.html">More...</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Releases</li>
    <li>
      <a href="https://github.com/neilstats/ckbplotr/releases/latest">Latest</a>
    </li>
    <li class="divider">
    <li>
      <a href="../news/index.html">Changelog</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/neilstats/ckbplotr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="adding_editing_code_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Changing generated code</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/neilstats/ckbplotr/blob/master/vignettes/adding_editing_code.Rmd"><code>vignettes/adding_editing_code.Rmd</code></a></small>
      <div class="hidden name"><code>adding_editing_code.Rmd</code></div>

    </div>

    
    
<p>The <code><a href="../reference/make_shape_plot.html">make_shape_plot()</a></code> and <code><a href="../reference/make_forest_plot.html">make_forest_plot()</a></code> functions generate code to produce plots. Beyond the function arguments, there are some further methods to change the generated code to produce customised plots.</p>
<div id="adding-layers" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-layers" class="anchor"></a>Adding layers</h2>
<p>The plots returned by <code><a href="../reference/make_shape_plot.html">make_shape_plot()</a></code> and <code><a href="../reference/make_forest_plot.html">make_forest_plot()</a></code> are ggplot objects, so you can use <code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code> to add more layers or adjust the theme.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">forest</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_forest_plot.html">make_forest_plot</a></span><span class="op">(</span>panels         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">resultsA</span>, <span class="va">resultsB</span><span class="op">)</span>,
                           col.key        <span class="op">=</span> <span class="st">"variable"</span>,
                           panel.headings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Analysis A"</span>, <span class="st">"Analysis B"</span><span class="op">)</span>,
                           showcode       <span class="op">=</span> <span class="cn">FALSE</span>,
                           printplot      <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="va">forest</span><span class="op">$</span><span class="va">plot</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"segment"</span>,
           x <span class="op">=</span> <span class="fl">0.71</span>,
           y <span class="op">=</span> <span class="fl">1</span>,
           xend <span class="op">=</span> <span class="fl">1.4</span>,
           yend <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"polygon"</span>,
           x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.85</span>, <span class="fl">1.37</span>, <span class="fl">1.37</span>, <span class="fl">0.85</span><span class="op">)</span>,
           y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">1.5</span>, <span class="op">-</span><span class="fl">1.5</span><span class="op">)</span>,
           fill <span class="op">=</span> <span class="cn">NA</span>,
           colour <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>plot.background <span class="op">=</span> <span class="fu">element_rect</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="adding_editing_code_files/figure-html/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="adding-code-the-addcode-argument" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-code-the-addcode-argument" class="anchor"></a>Adding code (the addcode argument)</h2>
<p>The addcode argument in <code><a href="../reference/make_shape_plot.html">make_shape_plot()</a></code> and <code><a href="../reference/make_forest_plot.html">make_forest_plot()</a></code> can be used to add additional code to the plot code created by the functions.</p>
<p>The argument should be a character vector. The first element defines where the code is added. It will be matched (as a regular expression) to the first line of the generated code (trimmed of any whitespace). The remaining elements will then be inserted as code just before this line. For example, to insert code before the line “# Plot points at the transformed estimates”, set “# Plot points at the transformed estimates” as the first element.</p>
<div id="example" class="section level3">
<h3 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h3>
<p>We wish to use <code>geom_segment()</code> to add dashed lines to the plot, and these should be added to the plot before the point estimates:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">forest</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_forest_plot.html">make_forest_plot</a></span><span class="op">(</span>panels         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">resultsA</span>, <span class="va">resultsB</span><span class="op">)</span>,
                           col.key        <span class="op">=</span> <span class="st">"variable"</span>,
                           panel.headings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Analysis A"</span>, <span class="st">"Analysis B"</span><span class="op">)</span>,
                           exponentiate   <span class="op">=</span> <span class="cn">TRUE</span>,
                           colour <span class="op">=</span> <span class="st">"grey"</span>,
                           addcode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"# Plot points at the transformed estimates"</span>,
                                       <span class="st">"# Plot dashed line"</span>,
                                       <span class="st">"geom_segment(aes(x = estimate_transformed, xend = estimate_transformed, y= -row, yend = -1),"</span>,
                                       <span class="st">"linetype = 'dashed',"</span>,
                                       <span class="st">"data = ~ dplyr::filter(.,row.label=='nmr_s_vldl_tg')) +"</span>,
                                       <span class="st">""</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning in sprintf("%s$", extension, ignore.case = TRUE): one argument not used</span>
<span class="co">#&gt; by format '%s$'</span></code></pre></div>
<p><img src="adding_editing_code_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="adding-aesthetics-and-arguments-the-addaes-and-addarg-arguments" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-aesthetics-and-arguments-the-addaes-and-addarg-arguments" class="anchor"></a>Adding aesthetics and arguments (the addaes and addarg arguments)</h2>
<p>The addaes and addarg arguments in <code><a href="../reference/make_shape_plot.html">make_shape_plot()</a></code> and <code><a href="../reference/make_forest_plot.html">make_forest_plot()</a></code> can be used to add additional aesthetics and arguments code to the ggplot layers created by the functions. These arguments must be named lists of character strings, and the names of elements defines where the aesthetics/arguments code is added.</p>
<p>In <code><a href="../reference/make_shape_plot.html">make_shape_plot()</a></code> the following names will add aesthetics and arguments to layers:</p>
<table class="table">
<thead><tr class="header">
<th>name</th>
<th>layer that plots</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>lines</td>
<td>lines of linear fit through estimates</td>
</tr>
<tr class="even">
<td>point</td>
<td>point estimates</td>
</tr>
<tr class="odd">
<td>estimates</td>
<td>text of estimates</td>
</tr>
<tr class="even">
<td>n</td>
<td>text of number of events (n)</td>
</tr>
<tr class="odd">
<td>ci</td>
<td>confidence intervals</td>
</tr>
</tbody>
</table>
<p>In <code><a href="../reference/make_forest_plot.html">make_forest_plot()</a></code> the following names will add aesthetics and arguments to layers:</p>
<table class="table">
<thead><tr class="header">
<th>name</th>
<th>layer that plots</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>ci</td>
<td>confidence intervals</td>
</tr>
<tr class="even">
<td>point</td>
<td>point estimates</td>
</tr>
<tr class="odd">
<td>col.right</td>
<td>col.right columns</td>
</tr>
<tr class="even">
<td>col.left</td>
<td>col.left columns</td>
</tr>
<tr class="odd">
<td>xlab</td>
<td>x-axis label</td>
</tr>
<tr class="even">
<td>panel.name</td>
<td>names above panels</td>
</tr>
</tbody>
</table>
<p>Where duplicate aesthetics/arguments might be defined and created, they are kept with the priority:</p>
<ol style="list-style-type: decimal">
<li>Aesthetic arguments specified using addaes and addarg</li>
<li>Aesthetic arguments created by the function</li>
<li>Other arguments specified using addaes and addarg</li>
<li>Other arguments created by the function</li>
</ol>
<p>This can be used to ‘overwrite’ some of the code that would otherwise be produced by <code><a href="../reference/make_shape_plot.html">make_shape_plot()</a></code> and <code><a href="../reference/make_forest_plot.html">make_forest_plot()</a></code>.</p>
<div id="example-1" class="section level3">
<h3 class="hasAnchor">
<a href="#example-1" class="anchor"></a>Example</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">forest</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_forest_plot.html">make_forest_plot</a></span><span class="op">(</span>panels         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">resultsA</span>, <span class="va">resultsB</span><span class="op">)</span>,
                           col.key        <span class="op">=</span> <span class="st">"variable"</span>,
                           panel.headings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Analysis A"</span>, <span class="st">"Analysis B"</span><span class="op">)</span>,
                           ciunder        <span class="op">=</span> <span class="cn">TRUE</span>,
                           addarg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>panel.name <span class="op">=</span> <span class="st">"colour = 'red'"</span><span class="op">)</span>,
                           addaes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>point <span class="op">=</span> <span class="st">"colour = dplyr::if_else(estimate_transformed &gt; 1.01, 'orange', 'grey')"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning in sprintf("%s$", extension, ignore.case = TRUE): one argument not used</span>
<span class="co">#&gt; by format '%s$'</span></code></pre></div>
<p><img src="adding_editing_code_files/figure-html/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="changing-the-code-vector-and-evaluating" class="section level2">
<h2 class="hasAnchor">
<a href="#changing-the-code-vector-and-evaluating" class="anchor"></a>Changing the code vector and evaluating</h2>
<p>The <code><a href="../reference/make_shape_plot.html">make_shape_plot()</a></code> and <code><a href="../reference/make_forest_plot.html">make_forest_plot()</a></code> functions return plot code in a character vector. You could change elements of the vector to customise the code, then parse and evaluate it using <code><a href="https://rdrr.io/r/base/eval.html">eval(parse(text = plotcode))</a></code>.</p>
</div>
<div id="copying-the-plot-code" class="section level2">
<h2 class="hasAnchor">
<a href="#copying-the-plot-code" class="anchor"></a>Copying the plot code</h2>
<p>If you want to make many changes to the plot code, then you can also copy and paste the code from the Viewer pane.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Neil Wright.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
